#region Using statements

using System;
using System.Diagnostics;
using System.IO;

#endregion Using statements

namespace WeekNumber
{
    internal static class MonitorProcess
    {
        /// <summary>
        /// Creates and runs WeekNumberMonitor.exe
        /// If WeekNumber.exe process is terminated it cleans up the taskbar icon and exits
        /// Only English OS GUI language supported
        /// </summary>
        internal static void Run()
        {
            string file = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), "Temp", "WeekNumberMonitor.exe");
            File.WriteAllBytes(file, Convert.FromBase64String(@"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GgA3AEUA1QIAAQUALgQBAAABBwBEBAEAAAEJAPcDAQAAAQsAogABAASAAAABAAAAAABEnQEAAABVAEMDAAAEAAAAAAAAAAAAAABMACUAAAAAAAQAAAAAAAAAAAAAAEwA9gIAAAAAAwACAAAAAEludDMyADxNb2R1bGU+AFJFQ1QAUmVmcmVzaFRyYXlBcmVhAG1zY29ybGliAEdldFByb2Nlc3NCeUlkAGhXbmQAR0NMYXJnZU9iamVjdEhlYXBDb21wYWN0aW9uTW9kZQBzZXRfTGFyZ2VPYmplY3RIZWFwQ29tcGFjdGlvbk1vZGUAR0NMYXRlbmN5TW9kZQBzZXRfTGF0ZW5jeU1vZGUAU2VuZE1lc3NhZ2UASURpc3Bvc2FibGUAd2luZG93SGFuZGxlAGxwQ2xhc3NOYW1lAGxwV2luZG93TmFtZQBTeXN0ZW0uUnVudGltZQBWYWx1ZVR5cGUARGlzcG9zZQBQYXJzZQBTVEFUaHJlYWRBdHRyaWJ1dGUAR3VpZEF0dHJpYnV0ZQBOZXV0cmFsUmVzb3VyY2VzTGFuZ3VhZ2VBdHRyaWJ1dGUARGVidWdnYWJsZUF0dHJpYnV0ZQBDb21WaXNpYmxlQXR0cmlidXRlAEFzc2VtYmx5VGl0bGVBdHRyaWJ1dGUAQXNzZW1ibHlUcmFkZW1hcmtBdHRyaWJ1dGUAVGFyZ2V0RnJhbWV3b3JrQXR0cmlidXRlAEFzc2VtYmx5RmlsZVZlcnNpb25BdHRyaWJ1dGUAQXNzZW1ibHlDb25maWd1cmF0aW9uQXR0cmlidXRlAEFzc2VtYmx5RGVzY3JpcHRpb25BdHRyaWJ1dGUAQ29tcGlsYXRpb25SZWxheGF0aW9uc0F0dHJpYnV0ZQBBc3NlbWJseVByb2R1Y3RBdHRyaWJ1dGUAQXNzZW1ibHlDb3B5cmlnaHRBdHRyaWJ1dGUAQXNzZW1ibHlDb21wYW55QXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmlsaXR5QXR0cmlidXRlAFdlZWtOdW1iZXJNb25pdG9yLmV4ZQBTeXN0ZW0uUnVudGltZS5WZXJzaW9uaW5nAG1zZwB1c2VyMzIuZGxsAGxQYXJhbQB3UGFyYW0AUHJvZ3JhbQBTeXN0ZW0AYm90dG9tAE1haW4AU3lzdGVtLlJlZmxlY3Rp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"));
            _ = new Process() 
            { 
                StartInfo = new ProcessStartInfo(file, Process.GetCurrentProcess().Id.ToString()) 
                {
                    CreateNoWindow = true,
                    WindowStyle = ProcessWindowStyle.Hidden,
                    UseShellExecute = false
                }
            }.Start();
        }
    }
}
